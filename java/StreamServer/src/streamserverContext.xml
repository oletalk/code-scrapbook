<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context-3.0.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd" xmlns:aop="http://www.springframework.org/schema/aop">
    <context:annotation-config />
    
    <bean 
class="org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor"/>
        
    <context:property-placeholder location="classpath:config.properties"/>
            
    <!-- reader of tags -->
    <bean id="tagDao" class="net.oletalk.stream.dao.TagDao"/>
    <bean id="tagReader" class="net.oletalk.stream.util.TagReader"/>
    <bean id="myDataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
        <property name="driverClassName" value="${dbdriver}"/>
        <property name="url" value="jdbc:${dburl}" />
        <property name="username" value="${dbuser}" />
        <property name="password" value="${dbpass}" />
    </bean>

    <!-- autowire chain follows... -->    
    <bean id="connxion" class="org.simpleframework.transport.connect.SocketConnection" autowire="constructor"/>
    <bean id="servercntr" class="org.simpleframework.http.core.ContainerServer" autowire="constructor" />
    <!-- (all flow/logic is in this one) -->
    <bean id="handler" class="net.oletalk.stream.StreamHandler"/>
    <!-- and the list of songs ... -->
    <bean id="songlist" class="net.oletalk.stream.data.SongList"/>


    <bean id="socketaddress" class="java.net.InetSocketAddress">
        <constructor-arg value="${port}" type="int"/>
    </bean>

    <!-- the server itself -->
    <bean id="server" class="net.oletalk.stream.StreamServer"/>

    <!-- side thread which populates untagged songs -->
    <bean id="populator" class="net.oletalk.stream.Populator"/>
    
</beans>
